# 纯虚函数（Pure Virtual Function）

面试官：我们来聊聊纯虚函数，你知道什么是纯虚函数吗？

候选人：纯虚函数就是在基类中声明但不提供实现的虚函数，用`= 0`来标记。它强制子类必须实现这个函数，否则子类也会变成抽象类。

---

## 一、纯虚函数的基本概念

面试官：那它和普通虚函数有什么区别？

候选人：普通虚函数基类有默认实现，子类可以选择重写或不重写。但纯虚函数基类没有实现，子类必须重写，否则编译报错。

面试官：为什么要用纯虚函数？

候选人：主要是为了定义接口规范。比如"形状"基类，面积计算每种形状都不一样，没法在基类实现，就用纯虚函数强制子类各自实现。

面试官：能举个生活例子吗？

候选人：就像"交通工具"基类，都有"移动"功能，但汽车、飞机、船移动方式完全不同，基类没法统一实现，就用纯虚函数。

> 代码引导：[纯虚函数基础练习](../../MyOutput/02-C++object/CodeOut/pure_virtual_function/basic_demo.cpp)

---

## 二、抽象类和接口

面试官：包含纯虚函数的类叫什么？

候选人：叫抽象类（Abstract Class）。抽象类不能直接实例化，只能作为基类被继承。

面试官：那抽象类和接口有什么区别？

候选人：C++没有专门的interface关键字，但可以用只有纯虚函数的抽象类来模拟接口。Java的interface在C++里就是纯虚函数类。

面试官：抽象类可以有普通成员函数吗？

候选人：可以！抽象类可以有普通成员函数、成员变量，甚至可以有普通虚函数。只有包含纯虚函数的类才是抽象类。

> 代码引导：[抽象类练习](../../MyOutput/02-C++object/CodeOut/pure_virtual_function/abstract_class_demo.cpp)

---

## 三、纯虚函数的高级用法

面试官：纯虚函数可以有实现吗？

候选人：可以！虽然很少见，但纯虚函数可以有实现。子类必须重写，但可以通过`BaseClass::pureVirtualFunction()`调用基类实现。

面试官：什么时候会用到这种用法？

候选人：比如基类想提供默认实现，但希望子类必须显式调用。或者基类实现有通用逻辑，子类在此基础上扩展。

面试官：纯虚析构函数呢？

候选人：纯虚析构函数必须有实现！因为析构时要从最底层开始析构，基类析构函数必须能被调用。

> 代码引导：[纯虚函数高级用法](../../MyOutput/02-C++object/CodeOut/pure_virtual_function/advanced_demo.cpp)

---

## 四、设计模式中的应用

面试官：纯虚函数在哪些设计模式中常用？

候选人：策略模式、模板方法模式、观察者模式等。比如策略模式，不同算法都实现同一个接口，用纯虚函数定义算法接口。

面试官：能举个具体例子吗？

候选人：比如排序算法，基类定义`sort()`纯虚函数，子类实现快速排序、归并排序等，客户端代码只需要用基类指针调用。

面试官：这样有什么好处？

候选人：代码更灵活，新增算法只需要继承基类实现纯虚函数，不需要修改现有代码，符合开闭原则。

> 代码引导：[设计模式应用练习](../../MyOutput/02-C++object/CodeOut/pure_virtual_function/design_pattern_demo.cpp)

---

## 高频面试追问

- 纯虚函数和虚函数的区别？
- 抽象类能实例化吗？为什么？
- 纯虚析构函数为什么必须有实现？
- 纯虚函数可以有实现吗？什么时候用？
- 纯虚函数在内存中占空间吗？

---

## 动手练习安排

请在`MyOutput/02-C++object/CodeOut/pure_virtual_function/`目录下，按TODO序号完成如下任务：

1. **基础练习** (`basic_demo.cpp`)：
   - 定义Shape抽象类，包含计算面积的纯虚函数
   - 实现Circle和Rectangle子类
   - 用基类指针调用不同子类的面积计算

2. **抽象类练习** (`abstract_class_demo.cpp`)：
   - 实现一个包含纯虚函数和普通函数的抽象类
   - 演示抽象类不能实例化
   - 展示子类必须实现纯虚函数

3. **高级用法练习** (`advanced_demo.cpp`)：
   - 实现有默认实现的纯虚函数
   - 演示纯虚析构函数的正确用法
   - 展示子类如何调用基类纯虚函数实现

4. **设计模式练习** (`design_pattern_demo.cpp`)：
   - 实现策略模式，用纯虚函数定义算法接口
   - 实现不同的排序算法子类
   - 演示客户端代码的灵活性

每个TODO建议7-8分钟内完成，遇到不会的地方可以先写伪代码。

完成后可参考答案：[Solution目录下的对应文件](../../MyOutput/02-C++object/CodeOut/pure_virtual_function/Solution/)

---

面试官：纯虚函数是C++面向对象设计的重要工具，理解好它对于写出好的抽象和接口非常重要！

候选人：是的，它帮助我们设计出更灵活、更易扩展的代码结构。

