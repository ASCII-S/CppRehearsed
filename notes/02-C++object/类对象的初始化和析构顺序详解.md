# 类对象的初始化和析构顺序详解

面试官：我们来聊聊C++里“类对象的初始化和析构顺序”。你能说说对象的构造和析构顺序是怎么决定的吗？

候选人：这个其实是C++面试的高频考点！我简单说下：

- **局部对象**：进入作用域时按定义顺序依次构造，离开作用域时按**逆序**依次析构。
- **全局/静态对象**：在main函数前初始化，程序结束时析构。
- **成员对象**：先于外部类对象构造，析构时后于外部类对象。
- **继承体系**：先构造父类，再构造子类；析构时顺序相反。

面试官：那如果有成员变量、父类、局部变量，谁先谁后？

候选人：
1. **父类先于子类构造**。
2. **成员变量按声明顺序构造**，在子类构造体执行前。
3. 析构顺序正好相反：先析构子类，再析构成员，再析构父类。

面试官：能举个例子吗？

候选人：当然！比如：

> 代码引导：[对象初始化和析构顺序练习](../../MyOutput/02-C++面向对象篇/CodeOut/init_destroy_order_demo.cpp)

---

## 高频面试追问

- 多个对象在同一作用域下，构造和析构顺序？
- 成员对象和父类的构造析构顺序？
- 静态对象和全局对象的初始化顺序？
- 构造函数和析构函数能不能调用虚函数？
- 为什么析构函数要是虚的？

---

## 知识点小结

- **局部对象**：进入作用域时构造，离开时逆序析构。
- **成员对象**：先于外部类构造，后于外部类析构。
- **继承体系**：父类先构造，子类后构造，析构顺序相反。
- **静态/全局对象**：main前构造，main后析构。

---

## 动手练习安排

请在`MyOutput/02-C++面向对象篇/CodeOut/init_destroy_order_demo.cpp`中，按TODO序号完成如下任务：
1. 定义一个有父类和成员对象的类，观察构造和析构顺序。
2. 在main函数中定义多个对象，观察作用域内的构造析构顺序。
3. 增加静态对象和全局对象，体会它们的初始化和析构时机。

每个TODO建议10分钟内完成，遇到不会的地方可以先写伪代码。

完成后可参考答案：[init_destroy_order_demo.cpp答案](../../MyOutput/02-C++面向对象篇/CodeOut/Solution/init_destroy_order_demo.cpp)

---

面试官：你对对象的初始化和析构顺序理解得很清楚，实际开发中遇到资源管理、RAII等场景时，这些知识非常重要！

